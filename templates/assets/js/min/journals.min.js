const journalContext={initEffect(){$(".joe_loading").remove(),$(".joe_journals__list").removeClass("hidden"),ThemeConfig.enable_journal_effect&&new WOW({boxClass:"wow",animateClass:ThemeConfig.journal_list_effect_class||"fadeIn",offset:0,mobile:!0,live:!0}).init()},formatTime(){$(".joe_journal-posttime").each(function(){var e=$(this);e.html(Utils.timeAgo(e.text()))})},initLike(){var e;ThemeConfig.enable_like_journal&&(e=$(".joe_journal__item")).length&&e.each(function(e,n){var o=$(this);const a=o.attr("data-cid"),l=+(o.attr("data-clikes")||0);let i=localStorage.getItem(encryption("agree-journal"))?JSON.parse(decrypt(localStorage.getItem(encryption("agree-journal")))):[],r=i.includes(a);const c=o.find(".journal-like"),s=o.find(".journal-unlike"),u=o.find(".journal-likes-num");r?(c.hide(),s.show()):(c.show(),s.hide()),u.html(l),c.on("click",function(e){e.stopPropagation();let n;n=!0,i=localStorage.getItem(encryption("agree-journal"))?JSON.parse(decrypt(localStorage.getItem(encryption("agree-journal")))):[],r=i.includes(a),$.ajax({url:"/apis/api.halo.run/v1alpha1/trackers/upvote",type:"post",contentType:"application/json; charset=utf-8",data:JSON.stringify({group:"moment.halo.run",plural:"moments",name:a})}).then(e=>{let n=l;r?(n--,o=i.findIndex(e=>e===a),i.splice(o,1),c.show(),s.hide()):(n++,i.push(a),c.hide(),s.show());var o=encryption("agree-journal"),t=encryption(JSON.stringify(i));localStorage.setItem(o,t),u.html(n)}).catch(e=>{})})})},initComment(){!ThemeConfig.enable_clean_mode&&ThemeConfig.enable_comment_journal&&$(".journal_comment_expander,.journal-comment").on("click",function(e){e.stopPropagation();e=$(this).parents(".footer-wrap");console.log("ping"),e.toggleClass("open"),e.find(".journal_comment_expander_txt").html((e.hasClass("open")?"收起":"查看")+"评论")})},initExpander(){$(".journal_content_expander i").on("click",function(e){e.stopPropagation(),$(this).parents(".joe_journal_body").toggleClass("open")})},foldBlock(){$(".joe_journal_body .content-wrp").each(function(){var e=$(this);e[0].getBoundingClientRect().height>=ThemeConfig.journal_block_height&&e.siblings(".journal_content_expander").show()})}};!function(){const n=["foldBlock"];document.addEventListener("DOMContentLoaded",function(){Object.keys(journalContext).forEach(e=>!n.includes(e)&&journalContext[e]())}),window.addEventListener("load",function(){journalContext.foldBlock()})}();